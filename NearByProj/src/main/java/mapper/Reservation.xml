<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.reservation">
	<insert id="insertReservation" parameterType="Reservation"
		useGeneratedKeys="true" keyProperty="number">
    <![CDATA[
       insert into Reservation (date,time,name,phone,address,opinion,subject,complete) values 
       (#{date},#{time},#{name},#{phone},#{address},#{opinion},#{subject},#{complete}) 
    ]]>
	</insert>

	<select id="cntMyReservation" parameterType="String" resultType="Integer">
	<![CDATA[
		SELECT COUNT(p.pidnum)
		FROM reservation r,
		hospital h,
		patient p
		WHERE 1=1
		AND r.pidnum = #{pidnum}
		AND r.comnum = h.comnum
		]]>
	</select>


	<select id='selectMyReservation' parameterType="String" resultType="hashmap">
   <![CDATA[
   select h.hname as name
        , h.hroad as address
        , h.htel as tel
        , r.resdate as date
        , r.restime as time
        , r.`status` as status
        , r.id as id
    from reservation r
       , hospital h
   where 1=1
     and r.pidnum = #{pidnum}
     and r.comnum = h.comnum
order by r.resdate desc
     ]]>
	</select>





</mapper>